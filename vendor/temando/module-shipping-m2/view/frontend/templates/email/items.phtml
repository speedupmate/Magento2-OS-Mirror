<?php
/**
 * Refer to LICENSE.txt distributed with the Temando Shipping module for notice of license
 */
?>

<?php
/** @var \Magento\Framework\View\Element\Template $block */
/** @var \Temando\Shipping\Model\PickupInterface $pickup */
$pickup = $block->getData('pickup');
/** @var \Magento\Sales\Model\Order $order */
$order = $block->getData('order');
$getProductName = function ($sku) use ($order) {
    foreach ($order->getItems() as $orderItem) {
        if ($orderItem->getSku() === $sku) {
            return $orderItem->getName();
        }
    }

    return '';
};

?>
<table class="email-items" summary="<?= $block->escapeHtml(__('Processed Items for Pickup')) ?>">
    <thead>
        <tr>
            <th><?= $block->escapeHtml(__('Product Name')) ?></th>
            <th><?= $block->escapeHtml(__('Quantity')) ?></th>
        </tr>
    </thead>
    <tbody>
    <?php foreach ($pickup->getItems() as $sku => $qty) : ?>
        <tr>
            <td>
                <p class="product-name"><?= $block->escapeHtml($getProductName($sku)) ?></p>
                <p class="sku"><?= $block->escapeHtml(__('SKU')) ?>: <?= $block->escapeHtml($sku) ?></p>
            </td>
            <td><?= $block->escapeHtml($qty) ?></td>
        </tr>
    <?php endforeach; ?>
    </tbody>
</table>
